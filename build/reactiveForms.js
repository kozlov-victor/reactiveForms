!function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};window.console||(window.console={},window.console.log=window.console.error=window.console.warn=function(t){window.status=t});var e="undefined"!=typeof HTMLElement?HTMLElement.prototype:Element.prototype;e.remove||(e.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),e.matches||function(t){t.matches||(t.matches=t.matchesSelector||function(t){var e=document.querySelectorAll(t),n=this;return Array.prototype.some.call(e,function(t){return t===n})})}(Element.prototype),e.closest||function(t){t.closest=t.closest||function(t){for(var e=this;e;){if(e.matches(t))return e;e=e.parentElement}return null}}(Element.prototype),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),Array.prototype.reduce||(Array.prototype.reduce=function(t){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var e=Object(this),n=e.length>>>0,o=0,r=void 0;if(arguments.length>=2)r=arguments[1];else{for(;o<n&&!(o in e);)o++;if(o>=n)throw new TypeError("Reduce of empty array with no initial value");r=e[o++]}for(;o<n;o++)o in e&&(r=t(r,e[o],o,e));return r}),Array.prototype.some||(Array.prototype.some=function(t){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof t)throw new TypeError;for(var e=Object(this),n=e.length>>>0,o=arguments.length>=2?arguments[1]:void 0,r=0;r<n;r++)if(r in e&&t.call(o,e[r],r,e))return!0;return!1}),"function"!=typeof Array.prototype.forEach&&(Array.prototype.forEach=function(e,n){if("number"==typeof this.length&&"function"==typeof e&&"object"==t(this))for(var o=0;o<this.length;o++){if(!(o in this))return;e.call(n||this,this[o],o,this)}}),[].filter||(Array.prototype.filter=function(t,e,n,o,r){n=this,o=[];for(r in n)~~r+""==r&&r>=0&&t.call(e,n[r],+r,n)&&o.push(n[r]);return o}),Array.prototype.map||(Array.prototype.map=function(t){for(var e=[],n=0,o=this.length;n<o;n++)e.push(t(this[n]));return e}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.startsWith||(String.prototype.startsWith=function(t){return!this.indexOf(t)}),Object.create||(Object.create=function(e,n){function o(){}if(o.prototype=e,"object"===(void 0===n?"undefined":t(n)))for(var r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);return new o}),window.Node||(window.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3}),function(t){var e,n=String.prototype.split,o=void 0===/()??/.exec("")[1];e=function(t,e,r){if("[object RegExp]"!==Object.prototype.toString.call(e))return n.call(t,e,r);var i,a,c,s,u=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),p=0,e=new RegExp(e.source,l+"g");for(t+="",o||(i=new RegExp("^"+e.source+"$(?!\\s)",l)),r=void 0===r?-1>>>0:r>>>0;(a=e.exec(t))&&!((c=a.index+a[0].length)>p&&(u.push(t.slice(p,a.index)),!o&&a.length>1&&a[0].replace(i,function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(a[t]=void 0)}),a.length>1&&a.index<t.length&&Array.prototype.push.apply(u,a.slice(1)),s=a[0].length,p=c,u.length>=r));)e.lastIndex===a.index&&e.lastIndex++;return p===t.length?!s&&e.test("")||u.push(""):u.push(t.slice(p)),u.length>r?u.slice(0,r):u},String.prototype.split=function(t,n){return e(this,t,n)}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,o,r){var i=this;n(this,t),this.parent=null,this.children=null,this.disableParentScopeEvaluation=!1,this.name=e,this.node=o,this.modelView=r,this.watchers=[],this.id=f.getUID(),this.domId=null,this.node.setAttribute("data-component-id",this.id),this.isWatchEnable=!0,this.stateExpression=null,p.nodeListToArray(this.node.querySelectorAll("*")).forEach(function(t){t.setAttribute("data-component-id",i.id)}),r.$el=o,t.instances.push(this)}return t.prototype.addChild=function(t){this.children||(this.children=[]),this.children.push(t)},t.prototype.setWatch=function(t){this.isWatchEnable=t,this.children&&this.children.forEach(function(e){e.isWatchEnable=t})},t.prototype.addWatcher=function(t,e){var n=w.getExpressionFn(t);this.watchers.push({expression:t,watcherFn:n,listenerFn:e}),e(w.runExpressionFn(n,this))},t.prototype._updateExternalState=function(){var t=this;if(this.stateExpression){var e=w.executeExpression(this.stateExpression,this.parent);Object.keys(e).forEach(function(n){t.modelView[n]!==e[n]&&(t.modelView[n]=e[n])})}},t.prototype.digest=function(){var t=this;this.isWatchEnable&&(this._updateExternalState(),this.watchers.forEach(function(e){var n=w.runExpressionFn(e.watcherFn,t),o=e.last,r=f.deepCopy(n);f.deepEqual(r,o)||e.listenerFn(n,o),e.last=r}))},t.prototype.run=function(){new m(this).run()},t.prototype.destroy=function(){this.node.remove(),this.children&&this.children.forEach(function(t){t.destroy()})},t.prototype.getComponentsByName=function(t){return this.children&&this.children.filter(function(e){return e.name==t})},t.prototype.getComponentById=function(t){return this.children&&this.children.filter(function(e){return e.domId==t})[0]},t.digestAll=function(){t.instances.forEach(function(t){t.digest()})},t.getComponentByInternalId=function(e){var n=null;return t.instances.some(function(t){if(t.id==e)return n=t,!0}),n},t.getComponentByDomId=function(e){var n=null;return t.instances.some(function(t){if(t.domId==e)return n=t,!0}),n},t}();o.instances=[];function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,o,r){n(this,t),this.name=e,this.node=o,this.properties=r}return t.prototype.newInstance=function(t,e){var n=new a(this.name,this.properties,e),r=new o(this.name,t,n);return n.component=r,r},t.getByName=function(e){return t.instances.filter(function(t){return t.name==e})[0]||null},t}();r.instances=[];function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){return"noChanged"},a=function(){function t(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(this,t),this.name=e||"",this.initialProperties=o,this.externalProperties=r,this.component=null,this.resetState({warnRedefined:!0}),this.onShow=this.onShow||i,this.onHide=this.onHide||i,this.onMount=this.onMount||i,this.onUnmount=this.onUnmount||i,this.onDestroy=this.onDestroy||i}return t.prototype.resetState=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.initialProperties;this._applyState(e);var n=e.getInitialState&&e.getInitialState();n&&(n=f.deepCopy(n)),n&&this._applyState(n,{warnRedefined:t}),this._applyState(this.externalProperties,{strict:!0}),this.component&&this.component._updateExternalState()},t.prototype._applyState=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.strict;Object.keys(e).forEach(function(r){if(o&&!t.hasOwnProperty(r))throw'\n                    can not apply non declared property "'+r+'" to component "'+t.name+'",\n                    declare property in getInitialState() method\n                ';n.warnRedefined&&e[r]&&t.hasOwnProperty(r)&&console.warn("property "+r+" is redefined at component "+t.name),t[r]=e[r]})},t}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=function(t){s(e,t);function e(o,r){return n(this,e),c(this,t.call(this,null,o,r))}return e}(o);function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var l=function(t){s(e,t);function e(o,r){n(this,e);var i=c(this,t.call(this,null,o,r));if(o.getAttribute("data-for"))throw'can not use "data-for" attribute at component directly. Use this directive at parent node';return i.scopedDomFragments=[],i.lastFrafmentsLength=0,i.node=o,i.parent=null,i}return e.prototype._destroyFragment=function(t){this.scopedDomFragments.splice(t,1)[0].destroy(),this.lastFrafmentsLength--},e.prototype.run=function(t,e,n){var o=this;this.eachItemName=t,this.indexName=e,this.anchor=document.createComment("component-id: "+this.id+"; loop: "+t+" in "+n),this.node.parentNode.insertBefore(this.anchor,this.node.nextSibling),this.node.remove(),this.node=this.node.cloneNode(!0),this.addWatcher(n,function(t,e){o._processIterations(t,e)})},e.prototype._processIterations=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(arguments[1],this.anchor);e instanceof Object&&(e=f.objectToArray(e));var o=0;if(e.forEach(function(e,r){if("key"in e&&"value"in e&&(r=e.key,e=e.value),t.scopedDomFragments[o]){var i=t.scopedDomFragments[o].modelView;i[t.eachItemName]=e,t.indexName&&(i[t.indexName]=r),n=t.scopedDomFragments[o].node,t.scopedDomFragments[o].digest()}else{var c={};c[t.eachItemName]=e,t.indexName&&(c[t.indexName]=r);var s=new a(t.indexName,c),l=t.node.cloneNode(!0),p=new u(l,s);n.parentNode.insertBefore(l,n.nextSibling),p.parent=t.parent,p.parent.addChild(p),p.run(),n=l,t.scopedDomFragments.push(p),t.lastFrafmentsLength++}o++}),this.lastFrafmentsLength>e.length)for(var r=this.scopedDomFragments.length,i=0,c=this.lastFrafmentsLength-e.length;i<c;i++)this._destroyFragment(r-i-1)},e}(o);function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var p=function(){function t(){n(this,t)}return t.processScopedTextNodes=function(e){var n=function(t){var e=[];n(t);Array.prototype.forEach.call(t.querySelectorAll("*"),n);return e;function n(t){e=e.concat(Array.prototype.filter.call(t.childNodes,function(t){return t.nodeType==Node.TEXT_NODE}))}}(e),o=[];return n.forEach(function(e){var n=document.createDocumentFragment(),r=!1;(e.textContent||e.innerText||e.data).split(t.EXPRESSION_REGEXP).forEach(function(t){var e=void 0,i=t.trim();if(0==i.indexOf("{{")){e=document.createTextNode("");var a=i.split("{{").join("").split("}}").join("");if(!a)return;r=!0,o.push({node:e,expression:a})}else e=document.createTextNode(t);n.appendChild(e)}),r&&e.parentNode.replaceChild(n,e)}),o},t.setInputValue=function(t,e){switch(t.tagName.toLowerCase()){case"input":switch(t.getAttribute("type")){case"checkbox":t.checked=!!e;break;case"radio":t.checked=e==t.value;break;default:t.value=e}break;case"select":case"textarea":t.value=e}},t.getInputValue=function(t){switch(t.tagName.toLowerCase()){case"input":switch(t.getAttribute("type")){case"checkbox":return t.checked;case"radio":for(var e=document.querySelectorAll('[type=radio][_data-model="'+t.getAttribute("_data-model")+'"]'),n=null,o=0;o<e.length;o++)if(e[o].checked){n=e[o];break}return n?n.value:"";default:return t.value}break;case"select":case"textarea":return t.value}},t.getDefaultInputChangeEvents=function(t){switch(t.tagName.toLowerCase()){case"input":switch(t.getAttribute("type")){case"checkbox":case"radio":return"click";case"range":case"number":return"input,change";default:return"keyup,input,change"}break;case"select":return"change";case"textarea":return"keyup";default:return"change"}},t.addEventListener=function(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent("on"+e,n)},t.setTextNodeValue=function(t,e){"textContent"in t?t.textContent=e:t.nodeValue=e},t.toggleClass=function(t,e,n){if(t.classList)return void t.classList.toggle(e,n);if(n)-1==t.className.indexOf(e)&&(t.className+=" "+e);else{var o=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(o," ")}},t.nodeListToArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},t.removeParentButNotChildren=function(e){for(var n=t.nodeListToArray(e.children);e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);return e.parentNode.removeChild(e),n},t.preventDefault=function(t){t=t||window.e,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1},t.getClosestElWithDataAttr=function(t,e){for(;t;){if(t===document)return;if(t.hasAttribute(e))return t;t=t.parentNode}},t}();p.EXPRESSION_REGEXP=/(\{\{[^\t]*?}})/;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var f=function(){function e(){n(this,e)}return e.deepCopy=function(n){if(void 0!==n){if(null===n)return null;if("[object Array]"===Object.prototype.toString.call(n)){for(var o=[],r=0,i=n.length;r<i;r++)o[r]=e.deepCopy(n[r]);return o}if("object"===(void 0===n?"undefined":t(n))){var a={};for(var c in n)a[c]=e.deepCopy(n[c]);return a}return n}},e.superficialCopy=function(t,e){t&&e&&Object.keys(e).forEach(function(n){t[n]=e[n]})},e.deepEqual=function(n,o){return n&&o&&"object"===(void 0===n?"undefined":t(n))&&"object"===(void 0===o?"undefined":t(o))?Object.keys(n).length===Object.keys(o).length&&Object.keys(n).reduce(function(t,r){return t&&e.deepEqual(n[r],o[r])},!0):n===o},e.camelToSnake=function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},e.getUID=function(){return d++},e.objectToArray=function(t){var e=[];return Object.keys(t).forEach(function(n){e.push({key:n,value:t[n]})}),e},e}(),d=0,t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var h=function(){function e(){n(this,e)}return e._getNodeFromDom=function(t,e){if(!t.value)throw console.error("can not process template at component "+e),"template.value must be specified";var n=document.getElementById(t.value);if(!n)throw"can not fing dom element with id "+t.value;return n},e._getNodeFromString=function(e,n){if(!e.value)throw"template string not provided";if("string"!=typeof e.value)throw console.error("can not process template at component "+n),"template.value mast be a String, but "+t(e.value)+" found";var o=document.createElement("div");return o.innerHTML=e.value,o},e.getNode=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],o=t.template;if(!o)throw"template object not defined. Provide template at your component '"+n+"'";switch(o.type){case"dom":return e._getNodeFromDom(o,n);case"string":return e._getNodeFromString(o,n);default:throw console.error("can not process template at component "+n),"can not load template with type "+o.type+', only "dom" and "string" types is supported'}},e}(),t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var m=function(){function e(t,o){n(this,e),this.component=t}return e.prototype._eachElementWithAttr=function(t,e){for(var n=[],o=this.component.node.querySelectorAll("["+t+"]"),r=0;r<o.length;r++)n.push(o[r]);this.component.node.hasAttribute(t)&&n.push(this.component.node),n.forEach(function(n){var o=n.getAttribute(t);n.removeAttribute(t),n.setAttribute("_"+t,o),!1===e(n,o)&&n.setAttribute(t,o)})},e.prototype.runDirective_For=function(){var t=this;this._eachElementWithAttr("data-for",function(e,n){var o=e.closest("[data-transclusion]");if(o&&!o.getAttribute("data-_processed"))return!1;var r=n.split(" ");if(-1==["in","of"].indexOf(r[1]))throw"can not parse expression "+n;var i=S.tokenize(r[0]).filter(function(t){return[b.TYPE.VARIABLE,b.TYPE.OBJECT_KEY].indexOf(t.tokenType)>-1}).map(function(t){return t.tokenValue});if(!i.length)throw"can not parse expression "+n;var a=i[0],c=i[1],s=r[2],u=new l(e,t.component.modelView);u.parent=t.component,u.run(a,c,s)})},e.prototype.runTextNodes=function(){var e=this;p.processScopedTextNodes(this.component.node).forEach(function(n){e.component.addWatcher(n.expression,function(e){"object"==(void 0===e?"undefined":t(e))&&(e=JSON.stringify(e)),p.setTextNodeValue(n.node,e)})})},e.prototype._runDomEvent=function(t,e,n){var r=this,i=t.closest("form"),a=!!i&&!i.__shouldPreventDefault__,c=w.getExpressionFn(e);a&&t!==i&&p.addEventListener(i,"submit",function(t){return p.preventDefault(t),!1}),p.addEventListener(t,n,function(t){if(w.runExpressionFn(c,r.component),o.digestAll(),"submit"==n)return p.preventDefault(t),!1}),i&&(i.__shouldPreventDefault__="__shouldPreventDefault__")},e.prototype.runDomEvent=function(t){var e=this;this._eachElementWithAttr("data-"+t,function(n,o){e._runDomEvent(n,o,t)})},e.prototype.runDomEvent_Change=function(){var t=this;this._eachElementWithAttr("data-change",function(e,n){["keyup","blur","input","change"].forEach(function(o){t._runDomEvent(e,n,o)})})},e.prototype.runDirective_Bind=function(){var t=this;this._eachElementWithAttr("data-bind",function(e,n){w.runExpressionFn(fn,t.component),t.component.addWatcher(n,function(t){p.setTextNodeValue(e,t)})})},e.prototype._runDirective_Model_OfSelect=function(t,e){var n=t.multiple,r=[];p.nodeListToArray(t.querySelectorAll("option")).filter(function(t){return t.selected}).forEach(function(t){var e=t.getAttribute("data-value"),n=void 0;n=o.getComponentByInternalId(t.getAttribute("data-component-id")),n&&e?r.push(w.executeExpression(e,n)):r.push(t.getAttribute("value"))}),w.setValueToContext(this.component,e,n?r:r[0])},e.prototype.runDirective_Model=function(){var t=this;this._eachElementWithAttr("data-model",function(e,n){"radio"!=e.getAttribute("type")||e.getAttribute("name")||e.setAttribute("name",n),p.getDefaultInputChangeEvents(e).split(",").forEach(function(r){"select"==e.tagName.toLowerCase()?p.addEventListener(e,r,function(r){t._runDirective_Model_OfSelect(e,n),o.digestAll()}):p.addEventListener(e,r,function(r){w.setValueToContext(t.component,n,p.getInputValue(e)),o.digestAll()})}),t.component.addWatcher(n,function(t){if("select"==e.tagName.toLowerCase()){var n=e.multiple,r=!1;p.nodeListToArray(e.querySelectorAll("option")).some(function(e){var i=e.getAttribute("data-value");if(i){var a=e.getAttribute("data-component-id"),c=o.getComponentByInternalId(a),s=w.executeExpression(i,c);if(n)t.indexOf(s)>-1?(r=!0,e.selected=!0):e.selected=!1;else if(s==t)return e.selected=!0,r=!0,!0}}),r||(e.value=t,n&&p.nodeListToArray(e.querySelectorAll("option")).forEach(function(e){e.selected=t.indexOf(e.getAttribute("value"))>-1}))}else p.getInputValue(e)!==t&&p.setInputValue(e,t)})})},e.prototype.runDirective_Class=function(){var e=this;this._eachElementWithAttr("data-class",function(n,o){var r=n.className;e.component.addWatcher(o,function(e){if("object"===(void 0===e?"undefined":t(e)))for(var o in e)e.hasOwnProperty(o)&&p.toggleClass(n,o,!!e[o]);else n.className=r+" "+e})})},e.prototype.runDirective_Style=function(){var t=this;this._eachElementWithAttr("data-style",function(e,n){t.component.addWatcher(n,function(t){for(var n in t)if(t.hasOwnProperty(n))try{e.style[n]=t[n]?t[n]:""}catch(t){}})})},e.prototype.runDirective_Disabled=function(){var t=this;this._eachElementWithAttr("data-disabled",function(e,n){t.component.addWatcher(n,function(t){t?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled")})})},e.prototype.runDirective_If=function(){var t=this;this._eachElementWithAttr("data-if",function(e,n){var o=document.createComment("");e.parentNode.insertBefore(o,e),t.component.addWatcher(n,function(n){n?e.parentElement||(o.parentNode.insertBefore(e,o.nextSibling),t.component.modelView.onMount(),t.component.modelView.onShow()):(t.component.modelView.onHide(),t.component.modelView.onUnmount(),e.remove())})})},e.prototype.runDirective_Show=function(){var t=this;this._eachElementWithAttr("data-show",function(e,n){var o=e.style.display||"";t.component.addWatcher(n,function(n){n?(e.style.display=o,t.component.modelView.onShow()):(e.style.display="none",t.component.modelView.onHide())})})},e.prototype.runDirective_Hide=function(){var t=this;this._eachElementWithAttr("data-hide",function(e,n){var o=e.style.display||"";t.component.addWatcher(n,function(n){n?(e.style.display="none",t.component.modelView.onHide()):(e.style.display=o,t.component.modelView.onShow())})})},e.prototype.runDirective_Html=function(){var t=this;this._eachElementWithAttr("data-html",function(e,n){t.component.addWatcher(n,function(t){e.innerHTML=t})})},e.prototype._runAttributes=function(t,e){Object.keys(e).forEach(function(n){var o=e[n];"boolean"==typeof o?o?t.setAttribute(n,n):t.removeAttribute(n):t.setAttribute(n,o)})},e.prototype.runDirective_Attributes=function(){var t=this;this._eachElementWithAttr("data-attributes",function(e,n){t.component.addWatcher(n,function(n){t._runAttributes(e,n)})})},e.prototype.runDirective_Attribute=function(){var t=this;this._eachElementWithAttr("data-attribute",function(e,n){n="{"+n,t.component.addWatcher(n,function(n){t._runAttributes(e,n)})})},e.prototype.runComponents=function(){var t=this,e=[];r.instances.forEach(function(n){var r=p.nodeListToArray(t.component.node.getElementsByTagName(n.name));if(t.component.node.tagName.toLowerCase()==n.name.toLowerCase())throw console.error('\n                   Can not use "data-for" attribute at component directly. Use "data-for" directive at parent node'),console.error("component node:",t.component.node),"Can not use data-for attribute at component";var i=[];r.forEach(function(o){if(!o.getAttribute("data-_processed")){o.setAttribute("data-_processed","1");var r=!1;p.nodeListToArray(o.childNodes).forEach(function(t){t.hasAttribute&&!t.hasAttribute("data-transclusion")&&(r=!0)}),r&&(console.warn(o),console.warn("children elements of component "+n.name+" will be removed"));var a=o.getAttribute("id"),c=n.node.cloneNode(!0);p.nodeListToArray(c.querySelectorAll("[data-transclusion]")).forEach(function(t){var r=t.getAttribute("data-transclusion");if(!r)throw console.error(n.node),console.error(t),"data-transclusion attribute can not be empty";p.nodeListToArray(o.querySelectorAll("[data-transclusion="+r+"]")).filter(function(t){var e=t.parentNode&&t.parentNode.closest("[data-transclusion="+r+"]");if(e)throw console.error(o),console.error(e),"transclusion name conflict: dont use same transclusion name at different components. Conflicted name: "+r;return!0}).forEach(function(n){t.innerHTML="",e.push({transclNode:t,rcp:n})})}),o.parentNode.insertBefore(c,o);var s=o.getAttribute("data-state"),u=s?w.executeExpression(s,t.component):{},l=n.newInstance(c,u);a&&(l.domId=a),l.parent=t.component,l.parent.addChild(l),s&&(l.stateExpression=s),l.disableParentScopeEvaluation=!0,l.run(),o.parentNode.removeChild(o),i.push({component:l,componentNode:c})}});var a=!1;i.forEach(function(t){var e=p.removeParentButNotChildren(t.componentNode);1==e.length?t.component.modelView.$el=e[0]:t.component.modelView.$el=e,a="noChanged"!=t.component.modelView.onMount()||a,a="noChanged"!=t.component.modelView.onShow()||a}),a&&o.digestAll()}),e.forEach(function(e){p.nodeListToArray(e.rcp.childNodes).forEach(function(t){e.transclNode.appendChild(t)});var n=new u(e.transclNode,new a(t.component.name));t.component.addChild(n),n.parent=t.component,e.transclNode.setAttribute("data-_processed","1"),n.run()})},e.prototype.runExpressionsInAttrs=function(){var t=this;p.nodeListToArray(this.component.node.querySelectorAll("*")).forEach(function(e){e.attributes&&Array.prototype.forEach.call(e.attributes,function(n){if(n){var o=n.name,r=n.value;if(-1!=r.indexOf("{{")||-1!=r.indexOf("}}")){r=r.split(/[\n\t]|[\s]{2,}/).join(" ").trim();var i=[],a="";r.split(p.EXPRESSION_REGEXP).forEach(function(t){t.length&&(0==t.indexOf("{{")?(t=t.split("{{").join("").split("}}").join(""),i.push("("+t+")")):i.push('"'+t+'"'))}),a=i.join("+"),t.component.addWatcher(a,function(t){e.setAttribute(o,t.trim())})}}})})},e.prototype.run=function(){var t=this;this.runDirective_For(),this.runComponents(),this.runTextNodes(),this.runDirective_Model(),["click","blur","focus","submit","keypress","keyup","keydown","input"].forEach(function(e){t.runDomEvent(e)}),this.runDomEvent_Change(),this.runDirective_Bind(),this.runDirective_Class(),this.runDirective_Style(),this.runDirective_Show(),this.runDirective_Hide(),this.runDirective_Disabled(),this.runDirective_Html(),this.runDirective_Attributes(),this.runExpressionsInAttrs(),this.runDirective_If()},e}(),t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var y=function e(n,o){if(!o)return n.modelView;var r=o.split("."),i=r.pop(),a=n.modelView,c=n.modelView;return r.forEach(function(e){void 0!==c&&(c=c[e],"object"===(void 0===c?"undefined":t(c))&&(a=c))}),void 0!==c&&(c=c[i]),!n.disableParentScopeEvaluation&&void 0===c&&n.parent?e(n.parent,o):c&&c.call?function(){return c.apply(a,Array.prototype.slice.call(arguments))}:c},v=function(t,e){return y(t,e)},E={getVal:v},g={},w=function(){function t(){n(this,t)}return t.getExpressionFn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t=t.split("\n").join("").split("'").join('"');var n="\n                return "+S.convertExpression(t,"__RF__.getVal(component,'{expr}')")+"\n        "+e;try{var o=new Function("component","__RF__",n);return o.expression=t,o.fnProcessed=o.toString(),o}catch(e){console.error("can not compile function from expression"),console.error("expression",t),console.error("compiled code",n)}},t.runExpressionFn=function(t,e){try{return t.call(e.modelView,e,E)}catch(n){throw console.error("getting value error"),console.error("can not evaluate expression:"+t.expression),console.error("     at compiled function:"+t.fnProcessed),console.error("component",e),n}},t.executeExpression=function(e,n){var o=g[e];return o||(o=g[e]=t.getExpressionFn(e)),t.runExpressionFn(o,n)},t.setValueToContext=function(t,e,n){var o=g[e];try{if(!o){var r=e.split(/(\..[_$a-zA-Z0-9]+)|(\[.+])/).filter(function(t){return!!t}),i=r.pop();0==i.indexOf("[")?(i=i.replace("[","").replace("]",""),i=S.convertExpression(i,"__RF__.getVal(component,'{expr}')"),i="["+i+"]"):r.length||(i="."+i),e=r.join(""),e=S.convertExpression(e,"__RF__.getVal(component,'{expr}')"),e=""+e+i+"=value",g[e]=o=new Function("component","__RF__","value",e)}o(t,E,n)}catch(r){throw console.error("setting value error"),console.error("current component",t),console.error("can not evaluate expression:"+e),console.error(" at compiled fn:",o),console.error("desired value to set",n),r}},t.getObjectFromString=function(t){try{return new Function("return ("+t+")")()}catch(e){throw console.error("can not parse properties: "+t),e}},t}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var b=function t(e,o){n(this,t),this.tokenType=e,this.tokenValue=o};b.SYMBOL={L_PAR:"(",R_PAR:")",L_CURLY:"{",R_CURLY:"}",L_SQUARE:"[",R_SQUARE:"]",COMMA:",",PLUS:"+",MULTIPLY:"*",MINUS:"-",DIVIDE:"/",GT:">",LT:"<",EQUAL:"=",QUESTION:"?",COLON:":",AMPERSAND:"&",OR:"|",EXCLAMATION:"!",SEMICOLON:";"},b.KEY_WORDS=["in","of","null","undefined"],b.ALL_SPECIAL_SYMBOLS=Object.keys(b.SYMBOL).map(function(t){return b.SYMBOL[t]}),b.TYPE={OPERATOR:"OPERATOR",DIGIT:"DIGIT",VARIABLE:"VARIABLE",STRING:"STRING",OBJECT_KEY:"OBJECT_KEY",FUNCTION:"FUNCTION",BOOLEAN:"BOOLEAN",KEY_WORD:"KEY_WORD"};function A(t){return!isNaN(parseFloat(t))&&isFinite(t)}function _(t,e){return t&&e.indexOf(t)>-1}var S=function(){function t(){n(this,t)}return t.tokenize=function(t){var e=t[t.length-1]==b.SYMBOL.SEMICOLON,n=[],o=void 0,r="";t=t.trim(),e||(t+=b.SYMBOL.SEMICOLON);var i=void 0;return t.split("").forEach(function(t,e){var a=n[n.length-1];if(a&&_(a.tokenValue,["true","false"])&&(a.tokenType=b.TYPE.BOOLEAN),_(t,['"',"'"])&&(i=!1),_(t,b.ALL_SPECIAL_SYMBOLS)&&!i){if(o=new b(b.TYPE.OPERATOR,t),n.push(o),r=t,!a)return;t!=b.SYMBOL.L_PAR||_(a.tokenValue,b.ALL_SPECIAL_SYMBOLS)||(a.tokenType=b.TYPE.FUNCTION)}else{if(a&&a.tokenType!=b.TYPE.STRING&&" "==t)return;if(!a||a.tokenType!=b.TYPE.DIGIT&&a.tokenType!=b.TYPE.VARIABLE&&a.tokenType!=b.TYPE.STRING){var c=void 0;A(t)?c=b.TYPE.DIGIT:_(t,['"',"'"])?(c=b.TYPE.STRING,i=!0):c=b.TYPE.VARIABLE,o=new b(c,t),n.push(o)}else a.tokenValue+=t;r=t}}),n.forEach(function(t,e){if(t.tokenValue&&(t.tokenValue=t.tokenValue.trim()),_(t.tokenValue,b.KEY_WORDS)&&(t.tokenType=b.KEY_WORDS),t&&t.tokenType==b.TYPE.VARIABLE){var o=n[e+1],r=n[e-1];o&&o.tokenValue==b.SYMBOL.COLON&&(!r||r&&"?"!==r.tokenValue)&&(t.tokenType=b.TYPE.OBJECT_KEY),t.tokenValue&&t.tokenValue.startsWith(".")&&(t.tokenType=b.TYPE.STRING)}t&&t.tokenType==b.TYPE.FUNCTION&&0==t.tokenValue.indexOf(".")&&(t.tokenType=b.TYPE.OBJECT_KEY)}),e||n.pop(),n},t.convertExpression=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"{expr}";if(!e)return n.replace("{expr}","");var o="";return e=e.split("\n").join(""),t.tokenize(e).forEach(function(t,r){if(t.tokenValue==b.SYMBOL.EQUAL&&t[r+1]&&t[r+1].tokenValue!=b.SYMBOL.EQUAL)throw'assign (like "a=b") not supported at directives for now, change your expression: '+e;[b.TYPE.VARIABLE,b.TYPE.FUNCTION].indexOf(t.tokenType)>-1?o+=n.replace("{expr}",t.tokenValue):o+=t.tokenValue||t.tokenType}),o},t}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var T=function(){function t(){n(this,t)}return t.navigateTo=function(t,e){location.hash=t},t.goBack=function(){window.history&&history.back()},t._check=function(t){var e=!1;if(t=t.substr(1),Object.keys(I._pages).some(function(n){var o={},r=n.match(/:([^\/]+)/g),i=t.match(new RegExp(n.replace(/:([^\/]+)/g,"([^/]*)")));if(i)return i.shift(),i.forEach(function(t,e){o[r[e].replace(":","")]=t}),e=!0,L(n,o),!0}),!e)throw"page with path "+t+" not registered, set up router correctly"},t.setup=function(){location.hash&&t._check(location.hash),p.addEventListener(window,"hashchange",function(){t._check(location.hash)})},t}(),N=function(){function t(){n(this,t)}return t.navigateTo=function(e,n){if(!I._pages[e])throw e+" not registered, set up router correctly";L(e,n),t.history.push({route:e,params:n})},t.setup=function(){},t.goBack=function(){t.history.pop();var e=t.history[t.history.length-1];e&&L(e.route,e.params)},t}();N.history=[];var x=function(){function t(){n(this,t)}return t.getRouterStrategy=function(t){switch(t){case I.STRATEGY.MANUAL:return N
;case I.STRATEGY.HASH:return T;default:throw"cat not find strategy with strategyName "+t}},t}(),O=null,C=void 0,L=function(t,e){if(C&&(C.component.modelView.onHide(),C.component.modelView.onUnmount(),C.component.setWatch(!1),p.nodeListToArray(O.childNodes).forEach(function(t){C.component.node.appendChild(t)})),!(C=I._pages[t]))throw"no page with name "+t+" registered";if(C.component)C.component.modelView.onShow(e);else{var n=C.componentProto.node.cloneNode(!0);C.component=C.componentProto.newInstance(n,{}),C.component.setWatch(!0),C.component.run(),C.component.modelView.onShow(e),delete C.componentProto}p.nodeListToArray(C.component.node.childNodes).forEach(function(t){O.appendChild(t)}),C.component.modelView.onMount(e),o.digestAll()},I=function(){function t(){n(this,t)}return t.setup=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.STRATEGY.MANUAL;t._strategy=x.getRouterStrategy(n);var o=document.querySelector("[data-route]");if(!o)throw"can not run Route: element with data-route attribute not found";o.innerHTML="",O=o,Object.keys(e).forEach(function(n){t._pages[n]={componentProto:e[n],component:null}}),t._strategy.setup()},t.navigateTo=function(e,n){t._strategy.navigateTo(e,n)},t.goBack=function(){t._strategy.goBack()},t}();I._pages={},I._strategy=null,I.STRATEGY={MANUAL:0,HASH:1};var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var k=function(){function e(){n(this,e)}return e.registerComponent=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if(t=f.camelToSnake(t),r.getByName(t))throw"component with name "+n+" already registered";var o=h.getNode(e,t),i=o.innerHTML;o.remove();var a=document.createElement("div");a.innerHTML=i;var c=new r(t,a,e);return r.instances.push(c),c},e.applyBindings=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw"ca not applyBindings: element selector not provided";if("string"!=typeof e)throw"element selector parameter mast me a string,\n            but "+(void 0===e?"undefined":t(e))+" found}";var o=document.querySelector(e);if(!o)throw"can not apply bindings: root element with selector "+e+" not defined";var r=new a(null,n),i=new u(o,r);return i.run(),r.onMount(),r.component=i,i},e.digest=function(){o.digestAll()},e.getComponentById=function(t){var e=o.getComponentByDomId(t);return e?e.modelView:null},e.getComponents=function(){return o.instances.map(function(t){return t.modelView})},e._getComponentByInternalId=function(t){return o.getComponentByInternalId(t)},e}();k.version="0.7.12",window.RF=k,window.RF.Router=I}();